<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vista de formulario simplificada -->
    <record id="view_ncf_fiscal_type_form" model="ir.ui.view">
        <field name="name">ncf.fiscal.type.form</field>
        <field name="model">ncf.fiscal.type</field>
        <field name="arch" type="xml">
            <form string="Tipo de Comprobante Fiscal">
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Ej: Factura de Cr√©dito Fiscal" required="1"/>
                        </h1>
                    </div>
                    <group>
                        <group string="üìã Configuraci√≥n B√°sica">
                            <field name="prefix" 
                                   string="Prefijo NCF" 
                                   required="1"
                                   placeholder="Ej: B01"
                                   help="Prefijo autorizado por DGII (B01, B02, B04, etc.)"/>
                            <field name="active" string="Activo"/>
                        </group>
                        <group string="üîÑ Informaci√≥n Autom√°tica" attrs="{'invisible': [('prefix', '=', False)]}">
                            <field name="code" 
                                   string="C√≥digo Extra√≠do" 
                                   readonly="1"
                                   help="Se extrae autom√°ticamente del prefijo"/>
                            <field name="sequence_id" 
                                   string="Secuencia Generada"
                                   readonly="1"
                                   help="Se crea autom√°ticamente"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="üí° Ayuda">
                            <div class="alert alert-info" role="alert">
                                <h4><strong>üéØ ¬°S√∫per F√°cil!</strong></h4>
                                <p><strong>Solo necesitas completar 2 campos:</strong></p>
                                <ul>
                                    <li><strong>Nombre:</strong> Describe el tipo de comprobante (ej: "Factura de Cr√©dito Fiscal")</li>
                                    <li><strong>Prefijo NCF:</strong> El c√≥digo autorizado por DGII (ej: "B01", "B02", "B04")</li>
                                </ul>
                                <p><strong>‚ú® El sistema autom√°ticamente:</strong></p>
                                <ul>
                                    <li>Extrae el c√≥digo del prefijo</li>
                                    <li>Crea la secuencia de numeraci√≥n</li>
                                    <li>Configura todo para que funcione</li>
                                </ul>
                            </div>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Vista de lista mejorada para selecci√≥n intuitiva -->
    <record id="view_ncf_fiscal_type_tree" model="ir.ui.view">
        <field name="name">ncf.fiscal.type.tree</field>
        <field name="model">ncf.fiscal.type</field>
        <field name="arch" type="xml">
            <tree string="Seleccionar Tipo de Comprobante" 
                  decoration-muted="not active"
                  decoration-bf="active"
                  create="false" 
                  edit="false" 
                  delete="false"
                  multi_edit="false">
                <field name="code" string="C√≥digo" width="80px"/>
                <field name="name" string="Tipo de Comprobante"/>
                <field name="prefix" string="Prefijo" width="100px"/>
                <field name="active" string="Activo" widget="boolean_toggle" width="80px"/>
            </tree>
        </field>
    </record>

    <!-- Vista Kanban para tipos fiscales -->
    <record id="view_ncf_fiscal_type_kanban" model="ir.ui.view">
        <field name="name">ncf.fiscal.type.kanban</field>
        <field name="model">ncf.fiscal.type</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="code"/>
                <field name="name"/>
                <field name="prefix"/>
                <field name="active"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_card oe_kanban_global_click #{record.active.raw_value ? '' : 'o_kanban_color_2'}">
                            <div class="o_kanban_content">
                                <div class="o_kanban_record_title">
                                    <strong>üìã <field name="name"/></strong>
                                </div>
                                <div class="o_kanban_record_subtitle">
                                    üî¢ C√≥digo: <field name="code"/> | üè∑Ô∏è Prefijo: <field name="prefix"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <!-- Acci√≥n para tipos fiscales -->
    <record id="action_ncf_fiscal_type" model="ir.actions.act_window">
        <field name="name">üìã Tipos de Comprobante Fiscal</field>
        <field name="res_model">ncf.fiscal.type</field>
        <field name="view_mode">tree,kanban,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                üéØ ¬°Cree sus tipos de comprobante fiscal!
            </p>
            <p>
                <strong>‚ú® ¬°S√∫per f√°cil! Solo necesita 2 campos:</strong><br/>
                üìù <strong>Nombre:</strong> Ej: "Factura de Cr√©dito Fiscal"<br/>
                üè∑Ô∏è <strong>Prefijo:</strong> Ej: "B01", "B02", "B04"<br/>
            </p>
            <p>
                <strong>üîÑ El sistema autom√°ticamente:</strong><br/>
                ‚Ä¢ Extrae el c√≥digo del prefijo<br/>
                ‚Ä¢ Crea la secuencia de numeraci√≥n<br/>
                ‚Ä¢ Configura todo para que funcione<br/>
            </p>
            <div class="alert alert-success">
                <strong>üí° Tip:</strong> Ya hay tipos predefinidos listos para usar. 
                Solo haga clic en "Nuevo" si necesita tipos adicionales.
            </div>
        </field>
    </record>

    <!-- Men√∫ para tipos fiscales -->
    <menuitem id="menu_ncf_fiscal_type" 
              name="üìã Tipos de Comprobante Fiscal" 
              parent="account.menu_finance_configuration" 
              action="action_ncf_fiscal_type"
              sequence="10"/>

    <!-- Acci√≥n mejorada para secuencias -->
    <record id="action_ncf_sequence_enhanced" model="ir.actions.act_window">
        <field name="name">üìä Secuencias NCF</field>
        <field name="res_model">ir.sequence</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('code', 'like', 'ncf.%')]</field>
        <field name="context">{'default_code': 'ncf.new', 'default_prefix': 'B01', 'default_padding': 8}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                üî¢ ¬°Configure las secuencias para sus NCF!
            </p>
            <p>
                Las secuencias generan autom√°ticamente los n√∫meros de
                comprobante fiscal seg√∫n los rangos autorizados por la DGII.
            </p>
        </field>
    </record>

    <!-- Men√∫ mejorado para secuencias -->
    <menuitem id="menu_ncf_sequence_enhanced" 
              name="üìä Secuencias NCF" 
              parent="account.menu_finance_configuration" 
              action="action_ncf_sequence_enhanced"
              sequence="11"/>

</odoo>